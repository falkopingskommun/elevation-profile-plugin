var ElevationProfile=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";t.exports=r,t.exports.default=r;var n=i(3);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],h(r,t.leaf?n(o):o);return r}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,o-n)}function _(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function y(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,i,r,o){for(var s,a=[e,i];a.length;)(i=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,n(t,s,e,i,o),a.push(e,s,s,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!y(t,e))return i;for(var r,o,s,a,h=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],y(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):_(t,a)?this._all(s,i):h.push(s));e=h.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!y(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],y(t,s=e.leaf?i(o):o)){if(e.leaf||_(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,s,a=this.data,h=this.toBBox(t),u=[],l=[];a||u.length;){if(a||(a=u.pop(),n=u[u.length-1],i=l.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;s||a.leaf||!_(a,h)?n?(i++,a=n.children[i],s=!1):a=null:(u.push(a),l.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=g([])).leaf=!1,r.height=n;var h,u,l,c,p=Math.ceil(o/a),f=p*Math.ceil(Math.sqrt(a));for(m(t,e,i,f,this.compareMinX),h=e;h<=i;h+=f)for(m(t,h,l=Math.min(h+f-1,i),p,this.compareMinY),u=h;u<=l;u+=p)c=Math.min(u+p-1,l),r.children.push(this._build(t,u,c,n-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,h,u,l,p;n.push(e),!e.leaf&&n.length-1!==i;){for(l=p=1/0,r=0,o=e.children.length;r<o;r++)h=c(s=e.children[r]),(u=f(t,s)-h)<p?(p=u,l=h<l?h:l,a=s):u===p&&h<l&&(l=h,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),h(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=g(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,h,u,l,p;for(u=l=1/0,n=e;n<=i-e;n++)s=d(r=a(t,0,n,this.toBBox),o=a(t,n,i,this.toBBox)),h=c(r)+c(o),s<u?(u=s,p=n,l=h<l?h:l):s===u&&h<l&&(l=h,p=n);return p},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,u=a(t,0,e,s),l=a(t,i-e,i,s),c=p(u)+p(l);for(r=e;r<i-e;r++)o=t.children[r],h(u,t.leaf?s(o):o),c+=p(u);for(r=i-e-1;r>=e;r--)o=t.children[r],h(l,t.leaf?s(o):o),c+=p(l);return c},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)h(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():s(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},,function(t,e,i){t.exports=i(4)},function(t,e,i){t.exports=function(){"use strict";function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}return function(i,n,r,o,s){!function e(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,h=n-r+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(h-a/2<0?-1:1);e(i,n,Math.max(r,Math.floor(n-h*l/a+c)),Math.min(o,Math.floor(n+(a-h)*l/a+c)),s)}var p=i[n],f=r,d=o;for(t(i,r,n),s(i[o],p)>0&&t(i,r,o);f<d;){for(t(i,f,d),f++,d--;s(i[f],p)<0;)f++;for(;s(i[d],p)>0;)d--}0===s(i[r],p)?t(i,r,d):t(i,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}(i,n,r||0,o||i.length-1,s||e)}}()},function(t,e,i){"use strict";function n(){return function(){throw new Error("Unimplemented abstract method.")}()}i.r(e);var r=0;function o(t){return t.ol_uid||(t.ol_uid=String(++r))}var s="5.3.0",a=function(t){function e(e){var i="Assertion failed. See https://openlayers.org/en/"+("latest"===s?s:"v"+s.split("-")[0])+"/doc/errors/#"+e+" for details.";t.call(this,i),this.code=e,this.name="AssertionError",this.message=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);function h(t,e){if(!t)throw new a(e)}function u(t,e,i){return Math.min(Math.max(t,e),i)}var l="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function c(t){return t*Math.PI/180}var p="Point",f=6371008.8;function d(t,e,i){var n=i||f,r=c(t[1]),o=c(e[1]),s=(o-r)/2,a=c(e[0]-t[0])/2,h=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}function _(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function y(t,e,i,n,r){return function(t,e,i,n,r){for(;i<n;i+=r)m(t,e[i],e[i+1]);return t}(function(t){return _(1/0,1/0,-1/0,-1/0,t)}(r),t,e,i,n)}function g(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function m(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function v(t){return t[3]-t[1]}var x={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},E={};E[x.DEGREES]=2*Math.PI*6370997/360,E[x.FEET]=.3048,E[x.METERS]=1,E[x.USFEET]=1200/3937;var C=x,w=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};w.prototype.canWrapX=function(){return this.canWrapX_},w.prototype.getCode=function(){return this.code_},w.prototype.getExtent=function(){return this.extent_},w.prototype.getUnits=function(){return this.units_},w.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||E[this.units_]},w.prototype.getWorldExtent=function(){return this.worldExtent_},w.prototype.getAxisOrientation=function(){return this.axisOrientation_},w.prototype.isGlobal=function(){return this.global_},w.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},w.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},w.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},w.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},w.prototype.setWorldExtent=function(t){this.worldExtent_=t},w.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},w.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var I=w,S=6378137,M=Math.PI*S,b=[-M,-M,M,M],O=[-180,-85,180,85],R=function(t){function e(e){t.call(this,{code:e,units:C.METERS,extent:b,global:!0,worldExtent:O,getPointResolution:function(t,e){return t/l(e[1]/S)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(I),L=[new R("EPSG:3857"),new R("EPSG:102100"),new R("EPSG:102113"),new R("EPSG:900913"),new R("urn:ogc:def:crs:EPSG:6.18:3:3857"),new R("urn:ogc:def:crs:EPSG::3857"),new R("http://www.opengis.net/gml/srs/epsg.xml#3857")];var k=[-180,-90,180,90],T=6378137*Math.PI/180,F=function(t){function e(e,i){t.call(this,{code:e,units:C.DEGREES,extent:k,axisOrientation:i,global:!0,metersPerUnit:T,worldExtent:k})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(I),X=[new F("CRS:84"),new F("EPSG:4326","neu"),new F("urn:ogc:def:crs:EPSG::4326","neu"),new F("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new F("urn:ogc:def:crs:OGC:1.3:CRS84"),new F("urn:ogc:def:crs:OGC:2:84"),new F("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new F("urn:x-ogc:def:crs:EPSG:4326","neu")],A={},G="function"==typeof Object.assign?Object.assign:function(t,e){var i=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,o=arguments.length;r<o;++r){var s=i[r];if(null!=s)for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])}return n};function P(t){for(var e in t)delete t[e]}function D(t){var e;for(e in t)return!1;return!e}var Y={};function z(t,e,i){var n=t.getCode(),r=e.getCode();n in Y||(Y[n]={}),Y[n][r]=i}function j(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function N(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function B(t){!function(t,e){A[t]=e}(t.getCode(),t),z(t,t,j)}function W(t){return"string"==typeof t?function(t){return A[t]||null}(t):t||null}function K(t){!function(t){t.forEach(B)}(t),t.forEach(function(e){t.forEach(function(t){e!==t&&z(e,t,j)})})}function U(t,e){return function(t,e){var i=function(t,e){var i;return t in Y&&e in Y[t]&&(i=Y[t][e]),i}(t.getCode(),e.getCode());return i||(i=N),i}(W(t),W(e))}function q(t,e,i){return U(e,i)(t,void 0,t.length)}function V(){return!0}function Z(){}K(L),K(X),function(t,e,i,n){X.forEach(function(t){e.forEach(function(e){z(t,e,i),z(e,t,n)})})}(0,L,function(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=M,a=0;a<n;a+=r){o[a]=s*t[a]/180;var h=S*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));h>s?h=s:h<-s&&(h=-s),o[a+1]=h}return o},function(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/M,o[s+1]=360*Math.atan(Math.exp(t[s+1]/S))/Math.PI-90;return o});var H="propertychange";function J(t,e,i,n){for(var r,o=0,s=t.length;o<s;++o)if((r=t[o]).listener===e&&r.bindTo===i)return n&&(r.deleteIndex=o),r}function Q(t,e){var i=$(t);return i?i[e]:void 0}function $(t,e){var i=t.ol_lm;return!i&&e&&(i=t.ol_lm={}),i}function tt(t,e){var i=Q(t,e);if(i){for(var n=0,r=i.length;n<r;++n)t.removeEventListener(e,i[n].boundListener),P(i[n]);i.length=0;var o=$(t);o&&(delete o[e],0===Object.keys(o).length&&function(t){delete t.ol_lm}(t))}}function et(t,e,i,n,r){var o=$(t,!0),s=o[e];s||(s=o[e]=[]);var a=J(s,i,n,!1);return a?r||(a.callOnce=!1):(a={bindTo:n,callOnce:!!r,listener:i,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var i=t.listener,n=t.bindTo||t.target;return t.callOnce&&rt(t),i.call(n,e)};return t.boundListener=e,e}(a)),s.push(a)),a}function it(t,e,i,n){return et(t,e,i,n,!0)}function nt(t,e,i,n){var r=Q(t,e);if(r){var o=J(r,i,n,!0);o&&rt(o)}}function rt(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=Q(t.target,t.type);if(e){var i="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&tt(t.target,t.type)}P(t)}}var ot=function(){this.disposed_=!1};ot.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},ot.prototype.disposeInternal=function(){};var st=ot,at=function(t){this.propagationStopped,this.type=t,this.target=null};at.prototype.preventDefault=function(){this.propagationStopped=!0},at.prototype.stopPropagation=function(){this.propagationStopped=!0};var ht=at,ut=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new ht(t):t,i=e.type;e.target=this;var n,r=this.listeners_[i];if(r){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var o=0,s=r.length;o<s;++o)if(!1===r[o].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,Z);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){!function(t){var e=$(t);if(e)for(var i in e)tt(t,i)}(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);t in this.pendingRemovals_?(i[n]=Z,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t])}},e}(st),lt="change",ct=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(lt)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=et(this,t[r],e);return n}return et(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=it(this,t[r],e);return n}return it(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)nt(this,t[i],e);else nt(this,t,e)},e}(ut),pt=function(t){function e(e,i,n){t.call(this,e),this.key=i,this.oldValue=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ht),ft={};function dt(t){return ft.hasOwnProperty(t)?ft[t]:ft[t]="change:"+t}var _t=function(t){function e(e){t.call(this),o(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return G({},this.values_)},e.prototype.notify=function(t,e){var i;i=dt(t),this.dispatchEvent(new pt(i,t,e)),i=H,this.dispatchEvent(new pt(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(ct);function yt(t,e){var i=document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function gt(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var mt=function(t){function e(e){t.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:Z,e.target&&this.setTarget(e.target)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){gt(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&gt(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)rt(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,this.map_&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Z&&this.listenerKeys.push(et(t,"postrender",this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(_t),vt=function(t){function e(e){if(t.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,et(this,dt(this.geometryName_),this.handleGeometryChanged_,this),e)if("function"==typeof e.getSimplifiedGeometry){var i=e;this.setGeometry(i)}else{var n=e;this.setProperties(n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(rt(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=et(t,lt,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:(h("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){nt(this,dt(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,et(this,dt(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},e}(_t),xt=function(t){var e=t||{};this.info=e.info||xt.prototype.info;var i,n=this;if(e.target)(i=document.createElement("div")).classList.add(e.className||"ol-profil");else{(i=document.createElement("div")).className=((e.className||"ol-profil")+" ol-unselectable ol-control ol-collapsed").trim(),this.button=document.createElement("button"),this.button.setAttribute("type","button");var r=function(t){n.toggle(),t.preventDefault()};this.button.addEventListener("click",r),this.button.addEventListener("touchstart",r),i.appendChild(this.button)}var o=document.createElement("div");o.classList.add("ol-inner"),i.appendChild(o);var s=document.createElement("div");s.style.position="relative",o.appendChild(s);var a=this.ratio=2;this.canvas_=document.createElement("canvas"),this.canvas_.width=(e.width||300)*a,this.canvas_.height=(e.height||150)*a;var h={msTransform:"scale(0.5,0.5)",msTransformOrigin:"0 0",webkitTransform:"scale(0.5,0.5)",webkitTransformOrigin:"0 0",mozTransform:"scale(0.5,0.5)",mozTransformOrigin:"0 0",transform:"scale(0.5,0.5)",transformOrigin:"0 0"};Object.keys(h).forEach(function(t){t in n.canvas_.style&&(n.canvas_.style[t]=h[t])});var u=document.createElement("div");s.appendChild(u),u.style.width=this.canvas_.width/a+"px",u.style.height=this.canvas_.height/a+"px",u.appendChild(this.canvas_),u.addEventListener("click",function(t){n.onMove(t)}),u.addEventListener("mousemove",function(t){n.onMove(t)}),mt.call(this,{element:i,target:e.target}),this.margin_={top:10*a,left:40*a,bottom:30*a,right:10*a},this.info.ytitle||(this.margin_.left-=20*a),this.info.xtitle||(this.margin_.bottom-=20*a),this.bar_=document.createElement("div"),this.bar_.classList.add("ol-profilbar"),this.bar_.style.top=this.margin_.top/a+"px",this.bar_.style.height=(this.canvas_.height-this.margin_.top-this.margin_.bottom)/a+"px",s.appendChild(this.bar_),this.cursor_=document.createElement("div"),this.cursor_.classList.add("ol-profilcursor"),s.appendChild(this.cursor_),this.popup_=document.createElement("div"),this.popup_.classList.add("ol-profilpopup"),this.cursor_.appendChild(this.popup_);var l=document.createElement("table");l.cellPadding="0",l.cellSpacing="0",l.style.clientWidth=this.canvas_.width/a+"px",s.appendChild(l);var c=document.createElement("tr");c.classList.add("track-info"),l.appendChild(c);var p=document.createElement("td");p.innerHTML=(this.info.zmin||"Zmin")+': <span class="zmin">',c.appendChild(p);var f=document.createElement("td");f.innerHTML=(this.info.zmax||"Zmax")+': <span class="zmax">',c.appendChild(f);var d=document.createElement("td");d.innerHTML=(this.info.distance||"Distance")+': <span class="dist">',c.appendChild(d);var _=document.createElement("td");_.innerHTML=(this.info.time||"Time")+': <span class="time">',c.appendChild(_);var y=document.createElement("tr");y.classList.add("point-info"),l.appendChild(y);var g=document.createElement("td");g.innerHTML=(this.info.altitude||"Altitude")+': <span class="z">',y.appendChild(g);var m=document.createElement("td");m.innerHTML=(this.info.distance||"Distance")+': <span class="dist">',y.appendChild(m);var v=document.createElement("td");v.innerHTML=(this.info.time||"Time")+': <span class="time">',y.appendChild(v),this.tab_=[],e.feature&&this.setGeometry(e.feature)};!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}(xt,mt),xt.prototype.info={zmin:"Zmin",zmax:"Zmax",ytitle:"Altitude (m)",xtitle:"Distance (km)",time:"Time",altitude:"Altitude",distance:"Distance"},xt.prototype.popup=function(t){this.popup_.innerHTML=t},xt.prototype.onMove=function(t){if(this.tab_.length){var e=this.canvas_.getBoundingClientRect(),i=e.top+window.pageYOffset-document.documentElement.clientTop,n=e.left+window.pageXOffset-document.documentElement.clientLeft,r=t.pageX-n,o=t.pageY-i,s=this.ratio;if(r>this.margin_.left/s&&r<(this.canvas_.width-this.margin_.right)/s&&o>this.margin_.top/s&&o<(this.canvas_.height-this.margin_.bottom)/s){this.bar_.style.left=r+"px",this.bar_.style.display="block";for(var a,h=(r*s-this.margin_.left)/this.scale_[0],u=this.tab_[0],l=1;a=this.tab_[l];l++)if(a[0]>=h){h<(a[0]+u[0])/2&&(a=u);break}a?(this.cursor_.style.left=r+"px",this.cursor_.style.top=(this.canvas_.height-this.margin_.bottom+a[1]*this.scale_[1]+this.dy_)/s+"px",this.cursor_.style.display="block"):this.cursor_.style.display="none",this.bar_.parentElement.classList.add("over"),this.element.querySelector(".point-info .z").textContent=a[1]+"m",this.element.querySelector(".point-info .dist").textContent=(a[0]/1e3).toFixed(1)+"km",this.element.querySelector(".point-info .time").textContent=a[2],r>this.canvas_.width/s/2?this.popup_.classList.add("ol-left"):this.popup_.classList.remove("ol-left"),this.dispatchEvent({type:"over",click:"click"==t.type,coord:a[3],time:a[2],distance:a[0]})}else this.bar_.parentElement.classList.contains("over")&&(this.bar_.style.display="none",this.cursor_.style.display="none",this.bar_.parentElement.classList.remove("over"),this.dispatchEvent({type:"out"}))}},xt.prototype.show=function(){this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"show",show:!0})},xt.prototype.hide=function(){this.element.classList.add("ol-collapsed"),this.dispatchEvent({type:"show",show:!1})},xt.prototype.toggle=function(){this.element.classList.toggle("ol-collapsed");var t=this.element.classList.contains("ol-collapsed");this.dispatchEvent({type:"show",show:!t})},xt.prototype.isShown=function(){return!this.element.classList.contains("ol-collapsed")},xt.prototype.setGeometry=function(t,e){e||(e={}),t instanceof vt&&(t=t.getGeometry());var i=this.canvas_,n=i.getContext("2d"),r=i.width,o=i.height;if(n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,r,o),/Z/.test(t.getLayout())){/M/.test(t.getLayout())?this.element.querySelector(".time").parentElement.style.display="block":this.element.querySelector(".time").parentElement.style.display="none";var s=t.getCoordinates();switch(t.getType()){case"LineString":break;case"MultiLineString":s=s[0];break;default:return}var a=e.projection||this.getMap().getView().getProjection();n.setTransform(1,0,0,1,this.margin_.left,o-this.margin_.bottom);var h=this.ratio;r-=this.margin_.right+this.margin_.left,o-=this.margin_.top+this.margin_.bottom,n.strokeStyle="#000",n.lineWidth=.5*h,n.beginPath(),n.moveTo(0,0),n.lineTo(0,-o),n.moveTo(0,0),n.lineTo(r,0),n.stroke();var u,l,c,p,f,_=1/0,y=-1/0,g=this.tab_=[];for(u=0;l=s[u];u++)(p=l[2])<_&&(_=p),p>y&&(y=p),0==u?c=0:c+=M(s[u-1],l),f=b(s[0][3],l[3]),g.push([c,p,f,l]);this.element.querySelector(".track-info .zmin").textContent=_.toFixed(2)+"m",this.element.querySelector(".track-info .zmax").textContent=y.toFixed(2)+"m",this.element.querySelector(".track-info .dist").textContent=c>1e3?(c/1e3).toFixed(1)+"km":c.toFixed(1)+"m",this.element.querySelector(".track-info .time").textContent=f;for(var m=e.graduation||100;o/(((y=Math.ceil(y/m)*m)-(_=Math.floor(_/m)*m))/m)<15*h;)m*=2;"number"==typeof e.zmin&&_>e.zmin&&(_=e.zmin),"number"==typeof e.zmax&&y<e.zmax&&(y=e.zmax);var v=e.amplitude;v&&(y=Math.max(_+v,y));var x=r/c,E=-o/(y-_),C=this.dy_=-_*E;for(this.scale_=[x,E],n.font=10*h+"px arial",n.textAlign="right",n.textBaseline="middle",n.fillStyle="#000",n.beginPath(),u=_;u<=y;u+=m)"km"!=e.zunit?n.fillText(u,-4*h,u*E+C):n.fillText((u/1e3).toFixed(1),-4*h,u*E+C),n.moveTo(-2*h,u*E+C),0!=u?n.lineTo(c*x,u*E+C):n.lineTo(0,u*E+C);n.textAlign="center",n.textBaseline="top",n.setLineDash([h,3*h]);var w,I=e.unit||"km";for(c>1e3?(w=100*Math.round(c/1e3))>1e3&&(w=1e3*Math.ceil(w/1e3)):(I="m",w=c>100?10*Math.round(c/100):c>10?Math.round(c/10):c>1?Math.round(c)/10:c),u=0;u<=c;u+=w){var S="m"==I?u:u/1e3;n.fillText(Math.round(10*S)/10,u*x,4*h),n.moveTo(u*x,2*h),n.lineTo(u*x,0)}for(n.font=12*h+"px arial",n.fillText(this.info.xtitle.replace("(km)","("+I+")"),r/2,18*h),n.save(),n.rotate(-Math.PI/2),n.fillText(this.info.ytitle,o/2,-this.margin_.left),n.restore(),n.stroke(),n.strokeStyle="#369",n.lineWidth=1,n.setLineDash([]),n.beginPath(),u=0;l=g[u];u++)0==u?n.moveTo(l[0]*x,l[1]*E+C):n.lineTo(l[0]*x,l[1]*E+C);n.stroke()}function M(t,e){return d(q(t,a,"EPSG:4326"),q(e,a,"EPSG:4326"))}function b(t,e){if(!t||!e)return"-";var i=(e-t)/60,n=Math.trunc(i/60),r=Math.trunc(i-60*n);return n+"h"+(r<10?"0":"")+r+"mn"}},xt.prototype.getImage=function(t,e){return"canvas"===t?this.canvas_:this.canvas_.toDataURL(t,e)};var Et=xt,Ct={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"},wt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"},It={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},St=function(t){function e(e){var i=G({},e);delete i.source,t.call(this,i),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),et(this,dt(wt.SOURCE),this.handleSourcePropertyChange_,this);var n=e.source?e.source:null;this.setSource(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(wt.SOURCE)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():It.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(rt(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=et(t,lt,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(rt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=et(t,"precompose",function(t){var e=t,i=this.getLayerState();i.managed=!1,void 0===this.getZIndex()&&(i.zIndex=1/0),e.frameState.layerStatesArray.push(i),e.frameState.layerStates[o(this)]=i},this),this.mapRenderKey_=et(this,lt,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(wt.SOURCE,t)},e}(function(t){function e(e){t.call(this);var i=G({},e);i[wt.OPACITY]=void 0!==e.opacity?e.opacity:1,i[wt.VISIBLE]=void 0===e.visible||e.visible,i[wt.Z_INDEX]=e.zIndex,i[wt.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,i[wt.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(i),this.state_=null,this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){var t=this.state_||{layer:this,managed:!0};return t.opacity=u(this.getOpacity(),0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=this.getZIndex()||0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),this.state_=t,t},e.prototype.getLayersArray=function(t){return n()},e.prototype.getLayerStatesArray=function(t){return n()},e.prototype.getExtent=function(){return this.get(wt.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(wt.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(wt.MIN_RESOLUTION)},e.prototype.getOpacity=function(){return this.get(wt.OPACITY)},e.prototype.getSourceState=function(){return n()},e.prototype.getVisible=function(){return this.get(wt.VISIBLE)},e.prototype.getZIndex=function(){return this.get(wt.Z_INDEX)},e.prototype.setExtent=function(t){this.set(wt.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(wt.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(wt.MIN_RESOLUTION,t)},e.prototype.setOpacity=function(t){this.set(wt.OPACITY,t)},e.prototype.setVisible=function(t){this.set(wt.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(wt.Z_INDEX,t)},e}(_t)),Mt={IMAGE:"image",VECTOR:"vector"};function bt(t){return"string"==typeof t?t:Ot(t)}function Ot(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function Rt(t){return Array.isArray(t)?Ot(t):t}var Lt="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",kt=(Lt.indexOf("firefox"),-1!==Lt.indexOf("safari")&&Lt.indexOf("chrom"),-1!==Lt.indexOf("webkit")&&Lt.indexOf("edge"),Lt.indexOf("macintosh"),window.devicePixelRatio,function(){var t=!1;try{t=!!document.createElement("canvas").getContext("2d").setLineDash}catch(t){}return t}()),Tt=(navigator,window,window,navigator.msPointerEnabled,2),Ft=(function(){var t,e={}}(),function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent("clear")},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var i=this.oldest_;i;)t.call(e,i.value_,i.key_,this),i=i.newer},e.prototype.get=function(t){var e=this.entries_[t];return h(void 0!==e,15),e===this.newest_?e.value_:(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e,e.value_)},e.prototype.remove=function(t){var e=this.entries_[t];return h(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){h(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(ut));new Array(6);var Xt=[0,0,0,1],At=[0,0,0,1];new Ft;!function(){var t=["monospace","serif"];t.length}();var Gt=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale};Gt.prototype.clone=function(){return new Gt({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},Gt.prototype.getOpacity=function(){return this.opacity_},Gt.prototype.getRotateWithView=function(){return this.rotateWithView_},Gt.prototype.getRotation=function(){return this.rotation_},Gt.prototype.getScale=function(){return this.scale_},Gt.prototype.getSnapToPixel=function(){return!1},Gt.prototype.getAnchor=function(){return n()},Gt.prototype.getImage=function(t){return n()},Gt.prototype.getHitDetectionImage=function(t){return n()},Gt.prototype.getImageState=function(){return n()},Gt.prototype.getImageSize=function(){return n()},Gt.prototype.getHitDetectionImageSize=function(){return n()},Gt.prototype.getOrigin=function(){return n()},Gt.prototype.getSize=function(){return n()},Gt.prototype.setOpacity=function(t){this.opacity_=t},Gt.prototype.setRotateWithView=function(t){this.rotateWithView_=t},Gt.prototype.setRotation=function(t){this.rotation_=t},Gt.prototype.setScale=function(t){this.scale_=t},Gt.prototype.setSnapToPixel=function(t){},Gt.prototype.listenImageChange=function(t,e){return n()},Gt.prototype.load=function(){n()},Gt.prototype.unlistenImageChange=function(t,e){n()};var Pt=function(t){function e(e){var i=e||{};t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,atlasManager:i.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(function(t){function e(e){var i=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:i,rotation:void 0!==e.rotation?e.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return Tt},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,i,n="",r="",o=0,s=null,a=0,h=0;this.stroke_&&(null===(i=this.stroke_.getColor())&&(i=At),i=Rt(i),void 0===(h=this.stroke_.getWidth())&&(h=1),s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),kt||(s=null,a=0),void 0===(r=this.stroke_.getLineJoin())&&(r="round"),void 0===(n=this.stroke_.getLineCap())&&(n="round"),void 0===(o=this.stroke_.getMiterLimit())&&(o=10));var u=2*(this.radius_+h)+1,l={strokeStyle:i,strokeWidth:h,size:u,lineCap:n,lineDash:s,lineDashOffset:a,lineJoin:r,miterLimit:o};if(void 0===t){var c=yt(u,u);this.canvas_=c.canvas,e=u=this.canvas_.width,this.draw_(l,c,0,0),this.createHitDetectionCanvas_(l)}else{u=Math.round(u);var p,f=!this.fill_;f&&(p=this.drawHitDetectionCanvas_.bind(this,l));var d=this.getChecksum(),_=t.add(d,u,u,this.draw_.bind(this,l),p);this.canvas_=_.image,this.origin_=[_.offsetX,_.offsetY],e=_.image.width,f?(this.hitDetectionCanvas_=_.hitImage,this.hitDetectionImageSize_=[_.hitImage.width,_.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[u/2,u/2],this.size_=[u,u],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,i,n){var r,o,s;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(a*=2),r=0;r<=a;r++)o=2*r*Math.PI/a-Math.PI/2+this.angle_,s=r%2==0?this.radius_:h,e.lineTo(t.size/2+s*Math.cos(o),t.size/2+s*Math.sin(o))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u=Xt),e.fillStyle=Rt(u),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=yt(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(r*=2),o=0;o<=r;o++)a=2*o*Math.PI/r-Math.PI/2+this.angle_,s=o%2==0?this.radius_:h,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=bt(Xt),e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var i="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[i,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(Gt)),Dt=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};Dt.prototype.clone=function(){var t=this.getColor();return new Dt({color:Array.isArray(t)?t.slice():t||void 0})},Dt.prototype.getColor=function(){return this.color_},Dt.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},Dt.prototype.getChecksum=function(){if(void 0===this.checksum_){var t=this.color_;t?Array.isArray(t)||"string"==typeof t?this.checksum_="f"+bt(t):this.checksum_=o(this.color_):this.checksum_="f-"}return this.checksum_};var Yt=Dt,zt=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};zt.prototype.clone=function(){var t=this.getColor();return new zt({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},zt.prototype.getColor=function(){return this.color_},zt.prototype.getLineCap=function(){return this.lineCap_},zt.prototype.getLineDash=function(){return this.lineDash_},zt.prototype.getLineDashOffset=function(){return this.lineDashOffset_},zt.prototype.getLineJoin=function(){return this.lineJoin_},zt.prototype.getMiterLimit=function(){return this.miterLimit_},zt.prototype.getWidth=function(){return this.width_},zt.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},zt.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},zt.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},zt.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},zt.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},zt.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},zt.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},zt.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=o(this.color_):this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};var jt=zt,Nt=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Kt,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};Nt.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Nt({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},Nt.prototype.getRenderer=function(){return this.renderer_},Nt.prototype.setRenderer=function(t){this.renderer_=t},Nt.prototype.getGeometry=function(){return this.geometry_},Nt.prototype.getGeometryFunction=function(){return this.geometryFunction_},Nt.prototype.getFill=function(){return this.fill_},Nt.prototype.setFill=function(t){this.fill_=t},Nt.prototype.getImage=function(){return this.image_},Nt.prototype.setImage=function(t){this.image_=t},Nt.prototype.getStroke=function(){return this.stroke_},Nt.prototype.setStroke=function(t){this.stroke_=t},Nt.prototype.getText=function(){return this.text_},Nt.prototype.setText=function(t){this.text_=t},Nt.prototype.getZIndex=function(){return this.zIndex_},Nt.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Kt,this.geometry_=t},Nt.prototype.setZIndex=function(t){this.zIndex_=t};var Bt=null;function Wt(t,e){if(!Bt){var i=new Yt({color:"rgba(255,255,255,0.4)"}),n=new jt({color:"#3399CC",width:1.25});Bt=[new Nt({image:new Pt({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return Bt}function Kt(t){return t.getGeometry()}var Ut=Nt,qt="renderOrder",Vt=function(t){function e(e){var i=e||{},n=G({},i);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,t.call(this,n),this.declutter_=void 0!==i.declutter&&i.declutter,this.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(i.style),this.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,this.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,this.renderMode_=i.renderMode||Mt.VECTOR,this.type=Ct.VECTOR}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(qt)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(qt,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:Wt,this.styleFunction_=null===t?void 0:function(t){var e,i;"function"==typeof t?e=t:(Array.isArray(t)?i=t:(h("function"==typeof t.getZIndex,41),i=[t]),e=function(){return i});return e}(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(St);Vt.prototype.getSource;var Zt=Vt,Ht="remove",Jt=function(t){function e(e,i){t.call(this,e),this.element=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ht),Qt=function(t){function e(e,i){t.call(this);var n=i||{};if(this.unique_=!!n.unique,this.array_=e||[],this.unique_)for(var r=0,o=this.array_.length;r<o;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get("length")},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Jt("add",e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Jt(Ht,e)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Jt(Ht,n)),this.dispatchEvent(new Jt("add",e))}else{for(var r=i;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set("length",this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new a(58)},e}(_t),$t={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};function te(t,e){return[[-1/0,-1/0,1/0,1/0]]}function ee(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var ie=function(t){function e(e){t.call(this),this.projection_=W(e.projection),this.attributions_=ee(e.attributions),this.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,this.loading=!1,this.state_=void 0!==e.state?e.state:It.READY,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return n()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=ee(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(_t),ne="addfeature",re="removefeature",oe=i(0),se=i.n(oe),ae=function(t){this.rbush_=se()(t,void 0),this.items_={}};ae.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[o(e)]=i},ae.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,r=e.length;n<r;n++){var s=t[n],a=e[n],h={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:a};i[n]=h,this.items_[o(a)]=h}this.rbush_.load(i)},ae.prototype.remove=function(t){var e=o(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},ae.prototype.update=function(t,e){var i=this.items_[o(e)];g([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},ae.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},ae.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},ae.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},ae.prototype.forEachInExtent=function(t,e,i){return this.forEach_(this.getInExtent(t),e,i)},ae.prototype.forEach_=function(t,e,i){for(var n,r=0,o=t.length;r<o;r++)if(n=e.call(i,t[r]))return n;return n},ae.prototype.isEmpty=function(){return D(this.items_)},ae.prototype.clear=function(){this.rbush_.clear(),this.items_={}},ae.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return _(e.minX,e.minY,e.maxX,e.maxY,t)},ae.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]};var he=ae,ue=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ht),le=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:void 0,state:It.READY,wrapX:void 0===i.wrapX||i.wrapX}),this.loader_=Z,this.format_=i.format,this.overlaps_=null==i.overlaps||i.overlaps,this.url_=i.url,void 0!==i.loader?this.loader_=i.loader:void 0!==this.url_&&(h(this.format_,7),this.loader_=function(t,e){return function(t,e,i,n){return function(i,r,o){var s=new XMLHttpRequest;s.open("GET","function"==typeof t?t(i,r,o):t,!0),e.getType()==$t.ARRAY_BUFFER&&(s.responseType="arraybuffer"),s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var i,r=e.getType();r==$t.JSON||r==$t.TEXT?i=s.responseText:r==$t.XML?(i=s.responseXML)||(i=(new DOMParser).parseFromString(s.responseText,"application/xml")):r==$t.ARRAY_BUFFER&&(i=s.response),i?function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}.call(this,e.readFeatures(i,{featureProjection:o}),e.readProjection(i),e.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),s.onerror=function(){n.call(this)}.bind(this),s.send()}}(t,e,0,Z)}(this.url_,this.format_)),this.strategy_=void 0!==i.strategy?i.strategy:te;var n,r,o=void 0===i.useSpatialIndex||i.useSpatialIndex;this.featuresRtree_=o?new he:null,this.loadedExtentsRtree_=new he,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(i.features)?r=i.features:i.features&&(r=(n=i.features).getArray()),o||void 0!==n||(n=new Qt(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==n&&this.bindFeaturesCollection_(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=o(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new ue(ne,t))}},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[et(e,lt,this.handleFeatureChange_,this),et(e,H,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n?n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e:(h(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],r=0,s=t.length;r<s;r++){var a=t[r],h=o(a);this.addToIndex_(h,a)&&i.push(a)}for(var u=0,l=i.length;u<l;u++){var c=i[u],p=o(c);this.setupChangeEvents_(p,c);var f=c.getGeometry();if(f){var d=f.getExtent();e.push(d),n.push(c)}else this.nullGeometryFeatures_[p]=c}this.featuresRtree_&&this.featuresRtree_.load(e,n);for(var _=0,y=i.length;_<y;_++)this.dispatchEvent(new ue(ne,i[_]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;et(this,ne,function(i){e||(e=!0,t.push(i.feature),e=!1)}),et(this,re,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),et(t,"add",function(t){e||(e=!0,this.addFeature(t.element),e=!1)},this),et(t,Ht,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)},this),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_)this.featureChangeKeys_[e].forEach(rt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var n=new ue("clear");this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0})},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),D(this.nullGeometryFeatures_)||function(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]}(t,function(t){var e=[];for(var i in t)e.push(t[i]);return e}(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],h=e||V;return this.featuresRtree_.forEachInExtent(a,function(t){if(h(t)){var e=t.getGeometry(),u=s;if((s=e.closestPointXY(i,n,o,s))<u){r=t;var l=Math.sqrt(s);a[0]=i-l,a[1]=n-l,a[2]=i+l,a[3]=n+l}}}),r},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=o(e),n=e.getGeometry();if(n){var r=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var s=e.getId();if(void 0!==s){var a=s.toString();i in this.undefIdIndex_?(delete this.undefIdIndex_[i],this.idIndex_[a]=e):this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else i in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[i]=e);this.changed(),this.dispatchEvent(new ue("changefeature",e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:o(t)in this.undefIdIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&D(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var n=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var s=function(t,s){var a=o[t];r.forEachInExtent(a,function(t){return function(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}(t.extent,a)})||(n.loader_.call(n,a,e,i),r.insert(a,{extent:a.slice()}),n.loading=n.loader_!==Z)},a=0,h=o.length;a<h;++a)s(a)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,function(i){if(g(i.extent,t))return e=i,!0}),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=o(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=o(t);this.featureChangeKeys_[e].forEach(rt),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i?delete this.idIndex_[i.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new ue(re,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e}(ie);var ce=[1,0,0,1,0,0],pe={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};function fe(t){var e;return t==pe.XY?e=2:t==pe.XYZ||t==pe.XYM?e=3:t==pe.XYZM&&(e=4),e}var de=function(t){function e(e,i){t.call(this),this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=function(t,e,i,n){var r=i-t,o=n-e;return r*r+o*o}(t,e,r[0],r[1]);if(o<n){for(var s=this.stride,a=0;a<s;++a)i[a]=r[a];return i.length=s,o}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return function(t,e){var i=t[0],n=t[1];return _(i,n,i,n,e)}(this.flatCoordinates,t)},e.prototype.getType=function(){return p},e.prototype.intersectsExtent=function(t){return function(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e}(this.flatCoordinates,0,t,this.stride),this.changed()},e}(function(t){function e(){t.call(this),this.layout=pe.XY,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return y(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return n()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(P(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=fe(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){n()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=fe(t);else{for(var r=0;r<i;++r){if(0===e.length)return this.layout=pe.XY,void(this.stride=2);e=e[0]}t=function(t){var e;return 2==t?e=pe.XY:3==t?e=pe.XYZ:4==t&&(e=pe.XYZM),e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],h=Math.cos(r),u=Math.sin(r),l=o[0],c=o[1],p=0,f=0;f<i;f+=n){var d=t[f]-l,_=t[f+1]-c;a[p++]=l+d*h-_*u,a[p++]=c+d*u+_*h;for(var y=f+2;y<f+n;++y)a[p++]=t[y]}s&&a.length!=p&&(a.length=p)}(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var r=i;r||(r=function(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,i,n,r,o,s,a){for(var h=a||[],u=s[0],l=s[1],c=0,p=0;p<i;p+=n){var f=t[p]-u,d=t[p+1]-l;h[c++]=u+r*f,h[c++]=l+o*d;for(var _=p+2;_<p+n;++_)h[c++]=t[_]}a&&h.length!=c&&(h.length=c)}(o,0,o.length,s,t,n,r,o),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],h=0,u=0;u<i;u+=n){a[h++]=t[u]+r,a[h++]=t[u+1]+o;for(var l=u+2;l<u+n;++l)a[h++]=t[l]}s&&a.length!=h&&(a.length=h)}(i,0,i.length,n,t,e,i),this.changed()}},e}(function(t){function e(){t.call(this),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return n()},e.prototype.closestPointXY=function(t,e,i,r){return n()},e.prototype.containsXY=function(t,e){return!1},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return n()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){n()},e.prototype.scale=function(t,e,i){n()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return n()},e.prototype.getType=function(){return n()},e.prototype.applyTransform=function(t){n()},e.prototype.intersectsExtent=function(t){return n()},e.prototype.translate=function(t,e){n()},e.prototype.transform=function(t,e){var i=W(t),n=i.getUnits()==C.TILE_PIXELS?function(t,n,r){var o=i.getExtent(),s=i.getWorldExtent(),a=v(s)/v(o);return function(t,e,i,n,r,o,s,a){var h=Math.sin(0),u=Math.cos(0);t[0]=n*u,t[1]=r*h,t[2]=-n*h,t[3]=r*u,t[4]=0*n*u-0*n*h+e,t[5]=0*r*h+0*r*u+i}(ce,s[0],s[3],a,-a),function(t,e,i,n,r,o){for(var s=o||[],a=0,h=e;h<i;h+=n){var u=t[h],l=t[h+1];s[a++]=r[0]*u+r[2]*l+r[4],s[a++]=r[1]*u+r[3]*l+r[5]}o&&s.length!=a&&(s.length=a)}(t,0,t.length,r,ce,n),U(i,e)(t,n,r)}:U(i,e);return this.applyTransform(n),this},e}(_t))),_e=function(t){var e,i,n,r,o,s=function(t,n,r){if(n.showProfile&&"LineString"===t.getGeometry().getType()&&t.getGeometry().getLayout()){var o=document.createElement("li"),s=new Et({target:o,width:240,info:{zmin:"Min höjd",zmax:"Max höjd",ytitle:"Höjd (m)",xtitle:"Distans (km)",time:"Tid",altitude:"Höjd",distance:"Distans"}});return e.addControl(s),s.setGeometry(t.getGeometry()),s.on(["over","out"],function(t){i&&("over"===t.type?(i.setGeometry(new de(t.coord)),i.setStyle(null)):i.setStyle([]))}),o}return!1};return Origo.ui.Component({name:"elevationProfile",onAdd:function(){},onInit:function(){e=t.getMap(),o=[new Ut({image:new Pt({radius:8,fill:new Yt({color:[0,153,255]}),stroke:new jt({color:[255,255,255],width:2})}),zIndex:1/0})],i=new vt(new de([0,0])),n=new le,r=new Zt({group:"none",source:n,style:o,name:"elevationProfile",visible:!0}),i.setStyle([]),e.addLayer(r),n.addFeature(i),t.getControlByName("featureInfo").addAttributeType("showProfile",s)},onRender:function(){},render:function(){}})};window.Origo&&(Origo.controls.ElevationProfile=_e);var ye=_e;e.default=ye}]).default;